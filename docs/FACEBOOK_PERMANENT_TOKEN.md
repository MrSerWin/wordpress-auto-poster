# üîê Facebook Permanent Token Setup

## –ü—Ä–æ–±–ª–µ–º–∞

Facebook Page Tokens –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 60 –¥–Ω–µ–π, —Ç—Ä–µ–±—É—è –º–∞–Ω—É–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: Permanent Token —á–µ—Ä–µ–∑ System User

Facebook –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å **–±–µ—Å—Å—Ä–æ—á–Ω—ã–π —Ç–æ–∫–µ–Ω**, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç.

---

## –ú–µ—Ç–æ–¥ 1: System User (Recommended)

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å Facebook App (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://developers.facebook.com/apps
2. –ù–∞–∂–º–∏—Ç–µ **Create App**
3. –í—ã–±–µ—Ä–∏—Ç–µ **Business** type
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å Business Manager Account

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://business.facebook.com
2. –°–æ–∑–¥–∞–π—Ç–µ Business Account (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
3. –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é Facebook Page –≤ Business Manager:
   - **Settings** ‚Üí **Accounts** ‚Üí **Pages**
   - –ù–∞–∂–º–∏—Ç–µ **Add** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å System User

1. –í Business Manager –ø–µ—Ä–µ–π–¥–∏—Ç–µ:
   - **Settings** ‚Üí **Users** ‚Üí **System Users**
2. –ù–∞–∂–º–∏—Ç–µ **Add**
3. –ò–º—è: `WordPress Auto Poster`
4. Role: **Admin**
5. –ù–∞–∂–º–∏—Ç–µ **Create System User**

### –®–∞–≥ 4: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Permanent Token

1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ System User
2. –ù–∞–∂–º–∏—Ç–µ **Generate New Token**
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞ (permissions):
   - ‚úÖ `pages_show_list`
   - ‚úÖ `pages_read_engagement`
   - ‚úÖ `pages_manage_posts`
   - ‚úÖ `pages_manage_engagement`
5. Token expiration: –≤—ã–±–µ—Ä–∏—Ç–µ **Never expire** (–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç)
6. –ù–∞–∂–º–∏—Ç–µ **Generate Token**
7. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** (–æ–Ω –±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è!)

### –®–∞–≥ 5: –î–æ–±–∞–≤–∏—Ç—å Page Access –¥–ª—è System User

1. –í Business Manager:
   - **Settings** ‚Üí **Accounts** ‚Üí **Pages**
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ù–∞–∂–º–∏—Ç–µ **Assign Partner** –∏–ª–∏ **Assign People**
4. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à System User
5. –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞:
   - ‚úÖ **Create content**
   - ‚úÖ **Moderate content**
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### –®–∞–≥ 6: –ü–æ–ª—É—á–∏—Ç—å Page Access Token

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –æ–±–º–µ–Ω—è—Ç—å System User Token –Ω–∞ Page Token:

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ:
# SYSTEM_USER_TOKEN - —Ç–æ–∫–µ–Ω –∏–∑ —à–∞–≥–∞ 4
# PAGE_ID - ID –≤–∞—à–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

curl -X GET "https://graph.facebook.com/v18.0/PAGE_ID?fields=access_token&access_token=SYSTEM_USER_TOKEN"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "access_token": "EAAxxxxx...",  // ‚Üê –≠—Ç–æ –≤–∞—à PERMANENT Page Token!
  "id": "632284956645073"
}
```

### –®–∞–≥ 7: –û–±–Ω–æ–≤–∏—Ç—å .env

```bash
FACEBOOK_PAGE_ID=632284956645073
FACEBOOK_ACCESS_TOKEN=EAAxxxxx...  # ‚Üê Permanent token –∏–∑ —à–∞–≥–∞ 6
```

‚úÖ **–ì–æ—Ç–æ–≤–æ!** –≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ—á–µ—Ç**.

---

## –ú–µ—Ç–æ–¥ 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Long-lived Token

–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å System User, –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

### –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```python
#!/usr/bin/env python3
"""
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Facebook Page Token
"""
import os
import requests
from dotenv import load_dotenv, set_key

load_dotenv()

def refresh_facebook_token():
    """–û–±–Ω–æ–≤–ª—è–µ—Ç Facebook Page Token"""

    # –î–∞–Ω–Ω—ã–µ –∏–∑ .env
    app_id = os.getenv('FACEBOOK_APP_ID')
    app_secret = os.getenv('FACEBOOK_APP_SECRET')
    current_token = os.getenv('FACEBOOK_ACCESS_TOKEN')
    page_id = os.getenv('FACEBOOK_PAGE_ID')

    if not all([app_id, app_secret, current_token, page_id]):
        print("‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ credentials –≤ .env")
        return False

    try:
        # –®–∞–≥ 1: –û–±–º–µ–Ω –Ω–∞ long-lived User Token
        print("üîÑ –û–±–º–µ–Ω –Ω–∞ long-lived User Token...")
        exchange_url = "https://graph.facebook.com/v18.0/oauth/access_token"
        params = {
            'grant_type': 'fb_exchange_token',
            'client_id': app_id,
            'client_secret': app_secret,
            'fb_exchange_token': current_token
        }

        response = requests.get(exchange_url, params=params)
        response.raise_for_status()

        long_lived_user_token = response.json().get('access_token')
        print(f"‚úÖ –ü–æ–ª—É—á–µ–Ω long-lived User Token")

        # –®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç—å Page Token –∏–∑ User Token
        print("üîÑ –ü–æ–ª—É—á–µ–Ω–∏–µ Page Token...")
        accounts_url = f"https://graph.facebook.com/v18.0/me/accounts"
        params = {'access_token': long_lived_user_token}

        response = requests.get(accounts_url, params=params)
        response.raise_for_status()

        pages = response.json().get('data', [])

        # –ù–∞–π—Ç–∏ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        page_token = None
        for page in pages:
            if page['id'] == page_id:
                page_token = page['access_token']
                break

        if not page_token:
            print(f"‚ùå –°—Ç—Ä–∞–Ω–∏—Ü–∞ {page_id} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
            return False

        print(f"‚úÖ –ü–æ–ª—É—á–µ–Ω –Ω–æ–≤—ã–π Page Token")

        # –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å .env —Ñ–∞–π–ª
        env_file = '.env'
        set_key(env_file, 'FACEBOOK_ACCESS_TOKEN', page_token)

        print(f"‚úÖ Token –æ–±–Ω–æ–≤–ª–µ–Ω –≤ .env —Ñ–∞–π–ª–µ")
        print(f"üìÖ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω ~60 –¥–Ω–µ–π")

        return True

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞: {e}")
        return False

if __name__ == "__main__":
    print("="*60)
    print("   –û–ë–ù–û–í–õ–ï–ù–ò–ï FACEBOOK PAGE TOKEN")
    print("="*60)
    print()

    success = refresh_facebook_token()

    if success:
        print()
        print("üéâ –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!")
    else:
        print()
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω")
```

### –î–æ–±–∞–≤–∏—Ç—å –≤ .env

```bash
# Facebook App credentials –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
FACEBOOK_APP_ID=your_app_id
FACEBOOK_APP_SECRET=your_app_secret
```

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (cron)

```bash
# –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–µ 50 –¥–Ω–µ–π
# crontab -e

# –ö–∞–∂–¥—ã–µ 50 –¥–Ω–µ–π –≤ 3:00 —É—Ç—Ä–∞
0 3 */50 * * cd /path/to/wordpress-auto-poster && python refresh_facebook_token.py
```

---

## –ú–µ—Ç–æ–¥ 3: Session-Based –ø–æ–¥—Ö–æ–¥ (–∫–∞–∫ Instagram)

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–ª—è Facebook –Ω–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–∞–∫ `instagrapi`. –ù–æ –µ—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:

### facebook-sdk —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–µ—Å—Å–∏–∏

```python
import facebook
import pickle
from pathlib import Path

class FacebookSessionPublisher:
    """Facebook publisher —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–µ—Å—Å–∏–∏"""

    def __init__(self):
        self.session_file = '.facebook_session.pkl'
        self.graph = None

    def load_session(self):
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é"""
        session_path = Path(self.session_file)
        if session_path.exists():
            try:
                with open(session_path, 'rb') as f:
                    token_data = pickle.load(f)

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
                self.graph = facebook.GraphAPI(token_data['access_token'])
                self.graph.get_object('me')  # Test

                return True
            except:
                return False
        return False

    def save_session(self, access_token):
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Å—Å–∏—é"""
        with open(self.session_file, 'wb') as f:
            pickle.dump({'access_token': access_token}, f)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** Facebook —Ç–æ–∫–µ–Ω—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –∏—Å—Ç–µ–∫–∞—é—Ç, —ç—Ç–æ –Ω–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –ø–æ–ª–Ω–æ—Å—Ç—å—é.

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ: System User + Permanent Token

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¢–æ–∫–µ–Ω **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç**
- ‚úÖ –ù—É–ª–µ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ Facebook
- ‚úÖ –ù–∞–¥–µ–∂–Ω—ã–π

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç Business Manager (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 10-15 –º–∏–Ω—É—Ç

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ Business Manager:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ cron
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 50 –¥–Ω–µ–π
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç App ID + App Secret

### –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

- ‚ùå –ö–∞–∂–¥—ã–µ 60 –¥–Ω–µ–π –≤—Ä—É—á–Ω—É—é
- ‚ùå –†–∏—Å–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚ùå Downtime –ø—É–±–ª–∏–∫–∞—Ü–∏–π

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------|-----------|---------------|-----------|--------------|
| **System User** | ‚ôæÔ∏è –ë–µ—Å—Å—Ä–æ—á–Ω–æ | –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è | –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **Auto-refresh** | 60 –¥–Ω–µ–π | Cron job | –ù–∏–∑–∫–∞—è | ‚≠ê‚≠ê‚≠ê‚≠ê |
| **Manual refresh** | 60 –¥–Ω–µ–π | –ù–µ—Ç | –ù–∏–∑–∫–∞—è | ‚≠ê‚≠ê |
| **Graph API Explorer** | 1-2 —á–∞—Å–∞ | –ù–µ—Ç | –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è | ‚≠ê |

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è

```bash
curl -X GET "https://graph.facebook.com/v18.0/debug_token?input_token=YOUR_TOKEN&access_token=YOUR_TOKEN"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "data": {
    "app_id": "123456",
    "type": "PAGE",  // ‚Üê –î–æ–ª–∂–µ–Ω –±—ã—Ç—å PAGE
    "is_valid": true,
    "expires_at": 0,  // ‚Üê 0 = –±–µ—Å—Å—Ä–æ—á–Ω—ã–π!
    "data_access_expires_at": 1234567890
  }
}
```

**`expires_at: 0`** = —Ç–æ–∫–µ–Ω –±–µ—Å—Å—Ä–æ—á–Ω—ã–π ‚úÖ

---

## –ì–æ—Ç–æ–≤–æ! üéâ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Permanent Token —É –≤–∞—Å –±—É–¥–µ—Ç:
- ‚úÖ Facebook —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ—á–µ—Ç**
- ‚úÖ –ù—É–ª–µ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- ‚úÖ –ù–∞–¥–µ–∂–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–æ–∑–¥–∞—Ç—å System User** (10 –º–∏–Ω—É—Ç)
2. **–ü–æ–ª—É—á–∏—Ç—å Permanent Token**
3. **–û–±–Ω–æ–≤–∏—Ç—å .env**
4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç:**
   ```bash
   python -c "from social_media_clients import FacebookPublisher; p = FacebookPublisher(); p.publish('Test', 'https://test.com')"
   ```

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–æ–∫–µ–Ω –±–µ—Å—Å—Ä–æ—á–Ω—ã–π:**
   ```bash
   # –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å expires_at: 0
   curl "https://graph.facebook.com/v18.0/debug_token?input_token=YOUR_TOKEN&access_token=YOUR_TOKEN"
   ```

---

**Happy permanent token! üöÄ**
